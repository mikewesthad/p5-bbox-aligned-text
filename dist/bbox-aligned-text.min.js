!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.BboxAlignedText=t()}}(function(){return function t(i,e,o){function s(h,r){if(!e[h]){if(!i[h]){var a="function"==typeof require&&require;if(!r&&a)return a(h,!0);if(n)return n(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var c=e[h]={exports:{}};i[h][0].call(c.exports,function(t){var e=i[h][1][t];return s(e?e:t)},c,c.exports,t,i,e,o)}return e[h].exports}for(var n="function"==typeof require&&require,h=0;h<o.length;h++)s(o[h]);return s}({1:[function(t,i,e){function o(t,i,e,s){this._font=t,this._text=i,this._fontSize=void 0!==e?e:12,this.p=s||window,this._rotation=0,this._hAlign=o.ALIGN.CENTER,this._vAlign=o.BASELINE.CENTER,this._calculateMetrics()}i.exports=o,o.ALIGN={LEFT:"left",CENTER:"center",RIGHT:"right"},o.BASELINE={TOP:"top",CENTER:"center",ALPHABETIC:"alphabetic",BOTTOM:"bottom"},o.prototype.setText=function(t){this._text=t,this._calculateMetrics()},o.prototype.setTextSize=function(t){this._fontSize=t,this._calculateMetrics()},o.prototype.setRotation=function(t){this._rotation=t},o.prototype.setAnchor=function(t,i){this._hAlign=t||o.ALIGN.CENTER,this._vAlign=i||o.BASELINE.CENTER},o.prototype.draw=function(t,i,e){e=e||!1;var o={x:void 0!==t?t:0,y:void 0!==i?i:0};if(this.p.push(),this._rotation&&(o=this._calculateRotatedCoords(o.x,o.y,this._rotation),this.p.rotate(this._rotation)),o=this._calculateAlignedCoords(o.x,o.y),this.p.textAlign(this.p.LEFT,this.p.BASELINE),this.p.textFont(this._font),this.p.textSize(this._fontSize),this.p.text(this._text,o.x,o.y),e){this.p.stroke(200);var s=o.x+this._boundsOffset.x,n=o.y+this._boundsOffset.y;this.p.noFill(),this.p.rect(s,n,this.width,this.height)}this.p.pop()},o.prototype._calculateRotatedCoords=function(t,i,e){var o=Math.cos(e)*t+Math.cos(Math.PI/2-e)*i,s=-Math.sin(e)*t+Math.sin(Math.PI/2-e)*i;return{x:o,y:s}},o.prototype._calculateAlignedCoords=function(t,i){var e,s;switch(this._hAlign){case o.ALIGN.LEFT:e=t;break;case o.ALIGN.CENTER:e=t-this.halfWidth;break;case o.ALIGN.RIGHT:e=t-this.width;break;default:e=t,console.log("Unrecognized horizonal align:",this._hAlign)}switch(this._vAlign){case o.BASELINE.TOP:s=i-this._boundsOffset.y;break;case o.BASELINE.CENTER:s=i+this._distBaseToMid;break;case o.BASELINE.BOTTOM:s=i-this._distBaseToBottom;break;case o.BASELINE.ALPHABETIC:s=i;break;default:s=i,console.log("Unrecognized vertical align:",this._vAlign)}return{x:e,y:s}},o.prototype._calculateMetrics=function(){var t=this._font.textBounds(this._text,1e3,1e3,this._fontSize);t.x-=1e3,t.y-=1e3,this.width=t.w,this.height=t.h,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this._boundsOffset={x:t.x,y:t.y},this._distBaseToMid=Math.abs(t.y)-this.halfHeight,this._distBaseToBottom=this.height-Math.abs(t.y)}},{}]},{},[1])(1)});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWIvYmJveC1hbGlnbmVkLXRleHQuanMiLCJiYm94LWFsaWduZWQtdGV4dC5qcyJdLCJuYW1lcyI6WyJmIiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsImciLCJ3aW5kb3ciLCJnbG9iYWwiLCJzZWxmIiwidGhpcyIsIkJib3hBbGlnbmVkVGV4dCIsImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJFcnJvciIsImNvZGUiLCJsIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJmb250IiwidGV4dCIsImZvbnRTaXplIiwicEluc3RhbmNlIiwiX2ZvbnQiLCJfdGV4dCIsIl9mb250U2l6ZSIsInVuZGVmaW5lZCIsInAiLCJfcm90YXRpb24iLCJfaEFsaWduIiwiQUxJR04iLCJDRU5URVIiLCJfdkFsaWduIiwiQkFTRUxJTkUiLCJfY2FsY3VsYXRlTWV0cmljcyIsIkxFRlQiLCJSSUdIVCIsIlRPUCIsIkFMUEhBQkVUSUMiLCJCT1RUT00iLCJwcm90b3R5cGUiLCJzZXRUZXh0Iiwic3RyaW5nIiwic2V0VGV4dFNpemUiLCJzZXRSb3RhdGlvbiIsImFuZ2xlIiwic2V0QW5jaG9yIiwiaEFsaWduIiwidkFsaWduIiwiZHJhdyIsIngiLCJ5IiwiZHJhd0JvdW5kcyIsInBvcyIsInB1c2giLCJfY2FsY3VsYXRlUm90YXRlZENvb3JkcyIsInJvdGF0ZSIsIl9jYWxjdWxhdGVBbGlnbmVkQ29vcmRzIiwidGV4dEFsaWduIiwidGV4dEZvbnQiLCJ0ZXh0U2l6ZSIsInN0cm9rZSIsImJvdW5kc1giLCJfYm91bmRzT2Zmc2V0IiwiYm91bmRzWSIsIm5vRmlsbCIsInJlY3QiLCJ3aWR0aCIsImhlaWdodCIsInBvcCIsInJ4IiwiTWF0aCIsImNvcyIsIlBJIiwicnkiLCJzaW4iLCJuZXdYIiwibmV3WSIsImhhbGZXaWR0aCIsImNvbnNvbGUiLCJsb2ciLCJfZGlzdEJhc2VUb01pZCIsIl9kaXN0QmFzZVRvQm90dG9tIiwiYm91bmRzIiwidGV4dEJvdW5kcyIsInciLCJoIiwiaGFsZkhlaWdodCIsImFicyJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsR0FBQSxHQUFBLGdCQUFBQyxVQUFBLG1CQUFBQyxRQUFBQSxPQUFBRCxRQUFBRCxRQUFBLElBQUEsa0JBQUFHLFNBQUFBLE9BQUFDLElBQUFELFVBQUFILE9BQUEsQ0FBQSxHQUFBSyxFQUFBQSxHQUFBLG1CQUFBQyxRQUFBQSxPQUFBLG1CQUFBQyxRQUFBQSxPQUFBLG1CQUFBQyxNQUFBQSxLQUFBQyxLQUFBSixFQUFBSyxnQkFBQVYsTUFBQSxXQUFBLE1BQUEsU0FBQVcsR0FBQUMsRUFBQUMsRUFBQUMsR0FBQSxRQUFBQyxHQUFBQyxFQUFBQyxHQUFBLElBQUFKLEVBQUFHLEdBQUEsQ0FBQSxJQUFBSixFQUFBSSxHQUFBLENBQUEsR0FBQUUsR0FBQSxrQkFBQUMsVUFBQUEsT0FBQSxLQUFBRixHQUFBQyxFQUFBLE1BQUFBLEdBQUFGLEdBQUEsRUFBQSxJQUFBSSxFQUFBLE1BQUFBLEdBQUFKLEdBQUEsRUFBQSxJQUFBaEIsR0FBQSxHQUFBcUIsT0FBQSx1QkFBQUwsRUFBQSxJQUFBLE1BQUFoQixHQUFBc0IsS0FBQSxtQkFBQXRCLEVBQUEsR0FBQXVCLEdBQUFWLEVBQUFHLElBQUFmLFdBQUFXLEdBQUFJLEdBQUEsR0FBQVEsS0FBQUQsRUFBQXRCLFFBQUEsU0FBQVUsR0FBQSxHQUFBRSxHQUFBRCxFQUFBSSxHQUFBLEdBQUFMLEVBQUEsT0FBQUksR0FBQUYsRUFBQUEsRUFBQUYsSUFBQVksRUFBQUEsRUFBQXRCLFFBQUFVLEVBQUFDLEVBQUFDLEVBQUFDLEdBQUEsTUFBQUQsR0FBQUcsR0FBQWYsUUFBQSxJQUFBLEdBQUFtQixHQUFBLGtCQUFBRCxVQUFBQSxRQUFBSCxFQUFBLEVBQUFBLEVBQUFGLEVBQUFXLE9BQUFULElBQUFELEVBQUFELEVBQUFFLEdBQUEs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R1csSUFBSSIsImZpbGUiOiJiYm94LWFsaWduZWQtdGV4dC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwibW9kdWxlLmV4cG9ydHMgPSBCYm94QWxpZ25lZFRleHQ7XHJcblxyXG4vKipcclxuICogQ3JlYXRlcyBhIG5ldyBCYm94QWxpZ25lZFRleHQgb2JqZWN0IC0gYSB0ZXh0IG9iamVjdCB0aGF0IGNhbiBiZSBkcmF3biB3aXRoXHJcbiAqIGFuY2hvciBwb2ludHMgYmFzZWQgb24gYSB0aWdodCBib3VuZGluZyBib3ggYXJvdW5kIHRoZSB0ZXh0LlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHBhcmFtIHtvYmplY3R9ICAgICAgICAgICAgICAgZm9udCAgICAgICAgICAgICAgIHA1LkZvbnQgb2JqZWN0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSAgICAgICAgICAgICAgIHRleHQgICAgICAgICAgICAgICBzdHJpbmcgdG8gZGlzcGxheVxyXG4gKiBAcGFyYW0ge251bWJlcn0gICAgICAgICAgICAgICBbZm9udFNpemU9MTJdICAgICAgZm9udCBzaXplIHRvIHVzZSBmb3Igc3RyaW5nXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICAgIFtwSW5zdGFuY2U9d2luZG93XSByZWZlcmVuY2UgdG8gcDUgaW5zdGFuY2UsIFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVhdmUgYmxhbmsgaWYgc2tldGNoIGlzIFxyXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsXHJcbiAqIEBleGFtcGxlXHJcbiAqIHZhciBmb250LCBiYm94VGV4dDtcclxuICogZnVuY3Rpb24gcHJlbG9hZCgpIHtcclxuICogICAgIGZvbnQgPSBsb2FkRm9udChcIi4vYXNzZXRzL1JlZ3VsYXIudHRmXCIpO1xyXG4gKiB9XHJcbiAqIGZ1bmN0aW9uIHNldHVwKCkge1xyXG4gKiAgICAgY3JlYXRlQ2FudmFzKDQwMCwgNjAwKTtcclxuICogICAgIGJhY2tncm91bmQoMCk7XHJcbiAqICAgICBcclxuICogICAgIGJib3hUZXh0ID0gbmV3IEJib3hBbGlnbmVkVGV4dChmb250LCBcIkhleSFcIiwgMzApO1xyXG4gKiAgICAgXHJcbiAqICAgICBmaWxsKFwiIzAwQThFQVwiKTtcclxuICogICAgIG5vU3Ryb2tlKCk7ICAgIFxyXG4gKiAgICAgYmJveFRleHQuc2V0Um90YXRpb24oUEkgLyA0KTtcclxuICogICAgIGJib3hUZXh0LnNldEFuY2hvcihCYm94QWxpZ25lZFRleHQuQUxJR04uQ0VOVEVSLCBcclxuICogICAgICAgICAgICAgICAgICAgICAgICBCYm94QWxpZ25lZFRleHQuQkFTRUxJTkUuQ0VOVEVSKTtcclxuICogICAgIGJib3hUZXh0LmRyYXcod2lkdGggLyAyLCBoZWlnaHQgLyAyLCB0cnVlKTtcclxuICogfVxyXG4gKi9cclxuZnVuY3Rpb24gQmJveEFsaWduZWRUZXh0KGZvbnQsIHRleHQsIGZvbnRTaXplLCBwSW5zdGFuY2UpIHtcclxuICAgIHRoaXMuX2ZvbnQgPSBmb250O1xyXG4gICAgdGhpcy5fdGV4dCA9IHRleHQ7XHJcbiAgICB0aGlzLl9mb250U2l6ZSA9IChmb250U2l6ZSAhPT0gdW5kZWZpbmVkKSA/IGZvbnRTaXplIDogMTI7XHJcbiAgICB0aGlzLnAgPSBwSW5zdGFuY2UgfHwgd2luZG93OyAvLyBJZiBpbnN0YW5jZSBpcyBvbWl0dGVkLCBhc3N1bWUgZ2xvYmFsIHNjb3BlXHJcbiAgICB0aGlzLl9yb3RhdGlvbiA9IDA7XHJcbiAgICB0aGlzLl9oQWxpZ24gPSBCYm94QWxpZ25lZFRleHQuQUxJR04uQ0VOVEVSO1xyXG4gICAgdGhpcy5fdkFsaWduID0gQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FLkNFTlRFUjtcclxuICAgIHRoaXMuX2NhbGN1bGF0ZU1ldHJpY3MoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcnRpY2FsIGFsaWdubWVudCB2YWx1ZXNcclxuICogQHB1YmxpY1xyXG4gKiBAc3RhdGljXHJcbiAqIEByZWFkb25seVxyXG4gKiBAZW51bSB7c3RyaW5nfVxyXG4gKi9cclxuQmJveEFsaWduZWRUZXh0LkFMSUdOID0ge1xyXG4gICAgTEVGVDogXCJsZWZ0XCIsXHJcbiAgICBDRU5URVI6IFwiY2VudGVyXCIsXHJcbiAgICBSSUdIVDogXCJyaWdodFwiXHJcbn07XHJcblxyXG4vKipcclxuICogQmFzZWxpbmUgYWxpZ25tZW50IHZhbHVlc1xyXG4gKiBAcHVibGljXHJcbiAqIEBzdGF0aWNcclxuICogQHJlYWRvbmx5XHJcbiAqIEBlbnVtIHtzdHJpbmd9XHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQuQkFTRUxJTkUgPSB7XHJcbiAgICBUT1A6IFwidG9wXCIsXHJcbiAgICBDRU5URVI6IFwiY2VudGVyXCIsXHJcbiAgICBBTFBIQUJFVElDOiBcImFscGhhYmV0aWNcIixcclxuICAgIEJPVFRPTTogXCJib3R0b21cIlxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldCBjdXJyZW50IHRleHRcclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIHRleHQgc3RyaW5nIHRvIGRpc3BsYXlcclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5wcm90b3R5cGUuc2V0VGV4dCA9IGZ1bmN0aW9uKHN0cmluZykge1xyXG4gICAgdGhpcy5fdGV4dCA9IHN0cmluZztcclxuICAgIHRoaXMuX2NhbGN1bGF0ZU1ldHJpY3MoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgY3VycmVudCB0ZXh0IHNpemVcclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0ge251bWJlcn0gZm9udFNpemUgdGV4dCBzaXplXHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQucHJvdG90eXBlLnNldFRleHRTaXplID0gZnVuY3Rpb24oZm9udFNpemUpIHtcclxuICAgIHRoaXMuX2ZvbnRTaXplID0gZm9udFNpemU7XHJcbiAgICB0aGlzLl9jYWxjdWxhdGVNZXRyaWNzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0IHJvdGF0aW9uIG9mIHRleHRcclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0ge251bWJlcn0gYW5nbGUgcm90YXRpb24gaW4gcmFkaWFuc1xyXG4gKi9cclxuQmJveEFsaWduZWRUZXh0LnByb3RvdHlwZS5zZXRSb3RhdGlvbiA9IGZ1bmN0aW9uKGFuZ2xlKSB7XHJcbiAgICB0aGlzLl9yb3RhdGlvbiA9IGFuZ2xlO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldCBhbmNob3IgcG9pbnQgZm9yIHRleHQgKGhvcml6b25hbCBhbmQgdmVydGljYWwgYWxpZ25tZW50KSByZWxhdGl2ZSB0b1xyXG4gKiBib3VuZGluZyBib3hcclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gW2hBbGlnbj1DRU5URVJdIGhvcml6b25hbCBhbGlnbm1lbnRcclxuICogQHBhcmFtIHtzdHJpbmd9IFt2QWxpZ249Q0VOVEVSXSB2ZXJ0aWNhbCBiYXNlbGluZVxyXG4gKi9cclxuQmJveEFsaWduZWRUZXh0LnByb3RvdHlwZS5zZXRBbmNob3IgPSBmdW5jdGlvbihoQWxpZ24sIHZBbGlnbikge1xyXG4gICAgdGhpcy5faEFsaWduID0gaEFsaWduIHx8IEJib3hBbGlnbmVkVGV4dC5BTElHTi5DRU5URVI7XHJcbiAgICB0aGlzLl92QWxpZ24gPSB2QWxpZ24gfHwgQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FLkNFTlRFUjtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBEcmF3cyB0aGUgdGV4dCBwYXJ0aWNsZSB3aXRoIHRoZSBzcGVjaWZpZWQgc3R5bGUgcGFyYW1ldGVyc1xyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSAge251bWJlcn0gIHggICAgICAgICAgICAgICAgICB4IGNvb3JkaW5hdGUgb2YgdGV4dCBhbmNob3JcclxuICogQHBhcmFtICB7bnVtYmVyfSAgeSAgICAgICAgICAgICAgICAgIHkgY29vcmRpbmF0ZSBvZiB0ZXh0IGFuY2hvclxyXG4gKiBAcGFyYW0gIHtib29sZWFufSBbZHJhd0JvdW5kcz1mYWxzZV0gZmxhZyBmb3IgZHJhd2luZyBib3VuZGluZyBib3hcclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKHgsIHksIGRyYXdCb3VuZHMpIHtcclxuICAgIGRyYXdCb3VuZHMgPSBkcmF3Qm91bmRzIHx8IGZhbHNlO1xyXG4gICAgdmFyIHBvcyA9IHtcclxuICAgICAgICB4OiAoeCAhPT0gdW5kZWZpbmVkKSA/IHggOiAwLCBcclxuICAgICAgICB5OiAoeSAhPT0gdW5kZWZpbmVkKSA/IHkgOiAwXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMucC5wdXNoKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9yb3RhdGlvbikge1xyXG4gICAgICAgICAgICBwb3MgPSB0aGlzLl9jYWxjdWxhdGVSb3RhdGVkQ29vcmRzKHBvcy54LCBwb3MueSwgdGhpcy5fcm90YXRpb24pO1xyXG4gICAgICAgICAgICB0aGlzLnAucm90YXRlKHRoaXMuX3JvdGF0aW9uKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHBvcyA9IHRoaXMuX2NhbGN1bGF0ZUFsaWduZWRDb29yZHMocG9zLngsIHBvcy55KTtcclxuXHJcbiAgICAgICAgdGhpcy5wLnRleHRBbGlnbih0aGlzLnAuTEVGVCwgdGhpcy5wLkJBU0VMSU5FKTtcclxuICAgICAgICB0aGlzLnAudGV4dEZvbnQodGhpcy5fZm9udCk7XHJcbiAgICAgICAgdGhpcy5wLnRleHRTaXplKHRoaXMuX2ZvbnRTaXplKTtcclxuICAgICAgICB0aGlzLnAudGV4dCh0aGlzLl90ZXh0LCBwb3MueCwgcG9zLnkpO1xyXG5cclxuICAgICAgICBpZiAoZHJhd0JvdW5kcykge1xyXG4gICAgICAgICAgICB0aGlzLnAuc3Ryb2tlKDIwMCk7XHJcbiAgICAgICAgICAgIHZhciBib3VuZHNYID0gcG9zLnggKyB0aGlzLl9ib3VuZHNPZmZzZXQueDtcclxuICAgICAgICAgICAgdmFyIGJvdW5kc1kgPSBwb3MueSArIHRoaXMuX2JvdW5kc09mZnNldC55O1xyXG4gICAgICAgICAgICB0aGlzLnAubm9GaWxsKCk7XHJcbiAgICAgICAgICAgIHRoaXMucC5yZWN0KGJvdW5kc1gsIGJvdW5kc1ksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTsgICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgdGhpcy5wLnBvcCgpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFByb2plY3QgdGhlIGNvb3JkaW5hdGVzICh4LCB5KSBpbnRvIGEgcm90YXRlZCBjb29yZGluYXRlIHN5c3RlbVxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAcGFyYW0gIHtudW1iZXJ9IHggICAgIHggY29vcmRpbmF0ZSAoaW4gdW5yb3RhdGVkIHNwYWNlKVxyXG4gKiBAcGFyYW0gIHtudW1iZXJ9IHkgICAgIHkgY29vcmRpbmF0ZSAoaW4gdW5yb3RhdGVkIHNwYWNlKVxyXG4gKiBAcGFyYW0gIHtudW1iZXJ9IGFuZ2xlIHJhZGlhbnMgb2Ygcm90YXRpb24gdG8gYXBwbHlcclxuICogQHJldHVybiB7b2JqZWN0fSAgICAgICBvYmplY3Qgd2l0aCB4ICYgeSBwcm9wZXJ0aWVzXHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQucHJvdG90eXBlLl9jYWxjdWxhdGVSb3RhdGVkQ29vcmRzID0gZnVuY3Rpb24gKHgsIHksIGFuZ2xlKSB7ICBcclxuICAgIHZhciByeCA9IE1hdGguY29zKGFuZ2xlKSAqIHggKyBNYXRoLmNvcyhNYXRoLlBJIC8gMiAtIGFuZ2xlKSAqIHk7XHJcbiAgICB2YXIgcnkgPSAtTWF0aC5zaW4oYW5nbGUpICogeCArIE1hdGguc2luKE1hdGguUEkgLyAyIC0gYW5nbGUpICogeTtcclxuICAgIHJldHVybiB7eDogcngsIHk6IHJ5fTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhdGVzIGRyYXcgY29vcmRpbmF0ZXMgZm9yIHRoZSB0ZXh0LCBhbGlnbmluZyBiYXNlZCBvbiB0aGUgYm91bmRpbmcgYm94LlxyXG4gKiBUaGUgdGV4dCBpcyBldmVudHVhbGx5IGRyYXduIHdpdGggY2FudmFzIGFsaWdubWVudCBzZXQgdG8gbGVmdCAmIGJhc2VsaW5lLCBzb1xyXG4gKiB0aGlzIGZ1bmN0aW9uIHRha2VzIGEgZGVzaXJlZCBwb3MgJiBhbGlnbm1lbnQgYW5kIHJldHVybnMgdGhlIGFwcHJvcHJpYXRlXHJcbiAqIGNvb3JkaW5hdGVzIGZvciB0aGUgbGVmdCAmIGJhc2VsaW5lLlxyXG4gKiBAcHJpdmF0ZVxyXG4gKiBAcGFyYW0gIHtudW1iZXJ9IHggICAgICB4IGNvb3JkaW5hdGVcclxuICogQHBhcmFtICB7bnVtYmVyfSB5ICAgICAgeSBjb29yZGluYXRlXHJcbiAqIEByZXR1cm4ge29iamVjdH0gICAgICAgIG9iamVjdCB3aXRoIHggJiB5IHByb3BlcnRpZXNcclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5wcm90b3R5cGUuX2NhbGN1bGF0ZUFsaWduZWRDb29yZHMgPSBmdW5jdGlvbih4LCB5KSB7XHJcbiAgICB2YXIgbmV3WCwgbmV3WTtcclxuICAgIHN3aXRjaCAodGhpcy5faEFsaWduKSB7XHJcbiAgICAgICAgY2FzZSBCYm94QWxpZ25lZFRleHQuQUxJR04uTEVGVDpcclxuICAgICAgICAgICAgbmV3WCA9IHg7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQmJveEFsaWduZWRUZXh0LkFMSUdOLkNFTlRFUjpcclxuICAgICAgICAgICAgbmV3WCA9IHggLSB0aGlzLmhhbGZXaWR0aDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBCYm94QWxpZ25lZFRleHQuQUxJR04uUklHSFQ6XHJcbiAgICAgICAgICAgIG5ld1ggPSB4IC0gdGhpcy53aWR0aDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3WCA9IHg7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVW5yZWNvZ25pemVkIGhvcml6b25hbCBhbGlnbjpcIiwgdGhpcy5faEFsaWduKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKHRoaXMuX3ZBbGlnbikge1xyXG4gICAgICAgIGNhc2UgQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FLlRPUDpcclxuICAgICAgICAgICAgbmV3WSA9IHkgLSB0aGlzLl9ib3VuZHNPZmZzZXQueTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBCYm94QWxpZ25lZFRleHQuQkFTRUxJTkUuQ0VOVEVSOlxyXG4gICAgICAgICAgICBuZXdZID0geSArIHRoaXMuX2Rpc3RCYXNlVG9NaWQ7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FLkJPVFRPTTpcclxuICAgICAgICAgICAgbmV3WSA9IHkgLSB0aGlzLl9kaXN0QmFzZVRvQm90dG9tO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEJib3hBbGlnbmVkVGV4dC5CQVNFTElORS5BTFBIQUJFVElDOlxyXG4gICAgICAgICAgICBuZXdZID0geTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgbmV3WSA9IHk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVW5yZWNvZ25pemVkIHZlcnRpY2FsIGFsaWduOlwiLCB0aGlzLl92QWxpZ24pO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxuICAgIHJldHVybiB7eDogbmV3WCwgeTogbmV3WX07XHJcbn07XHJcblxyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZXMgYm91bmRpbmcgYm94IGFuZCB2YXJpb3VzIG1ldHJpY3MgZm9yIHRoZSBjdXJyZW50IHRleHQgYW5kIGZvbnRcclxuICogQHByaXZhdGVcclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5wcm90b3R5cGUuX2NhbGN1bGF0ZU1ldHJpY3MgPSBmdW5jdGlvbigpIHsgIFxyXG4gICAgLy8gcDUgMC41LjAgaGFzIGEgYnVnIC0gdGV4dCBib3VuZHMgYXJlIGNsaXBwZWQgYnkgKDAsIDApXHJcbiAgICAvLyBDYWxjdWxhdGluZyBib3VuZHMgaGFja1xyXG4gICAgdmFyIGJvdW5kcyA9IHRoaXMuX2ZvbnQudGV4dEJvdW5kcyh0aGlzLl90ZXh0LCAxMDAwLCAxMDAwLCB0aGlzLl9mb250U2l6ZSk7XHJcbiAgICBib3VuZHMueCAtPSAxMDAwO1xyXG4gICAgYm91bmRzLnkgLT0gMTAwMDtcclxuXHJcbiAgICAvLyBVc2UgYm91bmRzIHRvIGNhbGN1bGF0ZSBmb250IG1ldHJpY3NcclxuICAgIHRoaXMud2lkdGggPSBib3VuZHMudztcclxuICAgIHRoaXMuaGVpZ2h0ID0gYm91bmRzLmg7XHJcbiAgICB0aGlzLmhhbGZXaWR0aCA9IHRoaXMud2lkdGggLyAyO1xyXG4gICAgdGhpcy5oYWxmSGVpZ2h0ID0gdGhpcy5oZWlnaHQgLyAyO1xyXG4gICAgdGhpcy5fYm91bmRzT2Zmc2V0ID0ge3g6IGJvdW5kcy54LCB5OiBib3VuZHMueX07XHJcbiAgICB0aGlzLl9kaXN0QmFzZVRvTWlkID0gTWF0aC5hYnMoYm91bmRzLnkpIC0gdGhpcy5oYWxmSGVpZ2h0O1xyXG4gICAgdGhpcy5fZGlzdEJhc2VUb0JvdHRvbSA9IHRoaXMuaGVpZ2h0IC0gTWF0aC5hYnMoYm91bmRzLnkpO1xyXG59OyIsIihmdW5jdGlvbihmKXtpZih0eXBlb2YgZXhwb3J0cz09PVwib2JqZWN0XCImJnR5cGVvZiBtb2R1bGUhPT1cInVuZGVmaW5lZFwiKXttb2R1bGUuZXhwb3J0cz1mKCl9ZWxzZSBpZih0eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kKXtkZWZpbmUoW10sZil9ZWxzZXt2YXIgZztpZih0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09XCJ1bmRlZmluZWRcIil7Zz1nbG9iYWx9ZWxzZSBpZih0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCIpe2c9c2VsZn1lbHNle2c9dGhpc31nLkJib3hBbGlnbmVkVGV4dCA9IGYoKX19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbm1vZHVsZS5leHBvcnRzID0gQmJveEFsaWduZWRUZXh0O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSBuZXcgQmJveEFsaWduZWRUZXh0IG9iamVjdCAtIGEgdGV4dCBvYmplY3QgdGhhdCBjYW4gYmUgZHJhd24gd2l0aFxyXG4gKiBhbmNob3IgcG9pbnRzIGJhc2VkIG9uIGEgdGlnaHQgYm91bmRpbmcgYm94IGFyb3VuZCB0aGUgdGV4dC5cclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBwYXJhbSB7b2JqZWN0fSAgICAgICAgICAgICAgIGZvbnQgICAgICAgICAgICAgICBwNS5Gb250IG9iamVjdFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gICAgICAgICAgICAgICB0ZXh0ICAgICAgICAgICAgICAgc3RyaW5nIHRvIGRpc3BsYXlcclxuICogQHBhcmFtIHtudW1iZXJ9ICAgICAgICAgICAgICAgW2ZvbnRTaXplPTEyXSAgICAgIGZvbnQgc2l6ZSB0byB1c2UgZm9yIHN0cmluZ1xyXG4gKiBAcGFyYW0ge29iamVjdH0gICAgICAgICAgICAgICBbcEluc3RhbmNlPXdpbmRvd10gcmVmZXJlbmNlIHRvIHA1IGluc3RhbmNlLCBcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlYXZlIGJsYW5rIGlmIHNrZXRjaCBpcyBcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFxyXG4gKiBAZXhhbXBsZVxyXG4gKiB2YXIgZm9udCwgYmJveFRleHQ7XHJcbiAqIGZ1bmN0aW9uIHByZWxvYWQoKSB7XHJcbiAqICAgICBmb250ID0gbG9hZEZvbnQoXCIuL2Fzc2V0cy9SZWd1bGFyLnR0ZlwiKTtcclxuICogfVxyXG4gKiBmdW5jdGlvbiBzZXR1cCgpIHtcclxuICogICAgIGNyZWF0ZUNhbnZhcyg0MDAsIDYwMCk7XHJcbiAqICAgICBiYWNrZ3JvdW5kKDApO1xyXG4gKiAgICAgXHJcbiAqICAgICBiYm94VGV4dCA9IG5ldyBCYm94QWxpZ25lZFRleHQoZm9udCwgXCJIZXkhXCIsIDMwKTtcclxuICogICAgIFxyXG4gKiAgICAgZmlsbChcIiMwMEE4RUFcIik7XHJcbiAqICAgICBub1N0cm9rZSgpOyAgICBcclxuICogICAgIGJib3hUZXh0LnNldFJvdGF0aW9uKFBJIC8gNCk7XHJcbiAqICAgICBiYm94VGV4dC5zZXRBbmNob3IoQmJveEFsaWduZWRUZXh0LkFMSUdOLkNFTlRFUiwgXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FLkNFTlRFUik7XHJcbiAqICAgICBiYm94VGV4dC5kcmF3KHdpZHRoIC8gMiwgaGVpZ2h0IC8gMiwgdHJ1ZSk7XHJcbiAqIH1cclxuICovXHJcbmZ1bmN0aW9uIEJib3hBbGlnbmVkVGV4dChmb250LCB0ZXh0LCBmb250U2l6ZSwgcEluc3RhbmNlKSB7XHJcbiAgICB0aGlzLl9mb250ID0gZm9udDtcclxuICAgIHRoaXMuX3RleHQgPSB0ZXh0O1xyXG4gICAgdGhpcy5fZm9udFNpemUgPSAoZm9udFNpemUgIT09IHVuZGVmaW5lZCkgPyBmb250U2l6ZSA6IDEyO1xyXG4gICAgdGhpcy5wID0gcEluc3RhbmNlIHx8IHdpbmRvdzsgLy8gSWYgaW5zdGFuY2UgaXMgb21pdHRlZCwgYXNzdW1lIGdsb2JhbCBzY29wZVxyXG4gICAgdGhpcy5fcm90YXRpb24gPSAwO1xyXG4gICAgdGhpcy5faEFsaWduID0gQmJveEFsaWduZWRUZXh0LkFMSUdOLkNFTlRFUjtcclxuICAgIHRoaXMuX3ZBbGlnbiA9IEJib3hBbGlnbmVkVGV4dC5CQVNFTElORS5DRU5URVI7XHJcbiAgICB0aGlzLl9jYWxjdWxhdGVNZXRyaWNzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWZXJ0aWNhbCBhbGlnbm1lbnQgdmFsdWVzXHJcbiAqIEBwdWJsaWNcclxuICogQHN0YXRpY1xyXG4gKiBAcmVhZG9ubHlcclxuICogQGVudW0ge3N0cmluZ31cclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5BTElHTiA9IHtcclxuICAgIExFRlQ6IFwibGVmdFwiLFxyXG4gICAgQ0VOVEVSOiBcImNlbnRlclwiLFxyXG4gICAgUklHSFQ6IFwicmlnaHRcIlxyXG59O1xyXG5cclxuLyoqXHJcbiAqIEJhc2VsaW5lIGFsaWdubWVudCB2YWx1ZXNcclxuICogQHB1YmxpY1xyXG4gKiBAc3RhdGljXHJcbiAqIEByZWFkb25seVxyXG4gKiBAZW51bSB7c3RyaW5nfVxyXG4gKi9cclxuQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FID0ge1xyXG4gICAgVE9QOiBcInRvcFwiLFxyXG4gICAgQ0VOVEVSOiBcImNlbnRlclwiLFxyXG4gICAgQUxQSEFCRVRJQzogXCJhbHBoYWJldGljXCIsXHJcbiAgICBCT1RUT006IFwiYm90dG9tXCJcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgY3VycmVudCB0ZXh0XHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyB0ZXh0IHN0cmluZyB0byBkaXNwbGF5XHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQucHJvdG90eXBlLnNldFRleHQgPSBmdW5jdGlvbihzdHJpbmcpIHtcclxuICAgIHRoaXMuX3RleHQgPSBzdHJpbmc7XHJcbiAgICB0aGlzLl9jYWxjdWxhdGVNZXRyaWNzKCk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0IGN1cnJlbnQgdGV4dCBzaXplXHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHtudW1iZXJ9IGZvbnRTaXplIHRleHQgc2l6ZVxyXG4gKi9cclxuQmJveEFsaWduZWRUZXh0LnByb3RvdHlwZS5zZXRUZXh0U2l6ZSA9IGZ1bmN0aW9uKGZvbnRTaXplKSB7XHJcbiAgICB0aGlzLl9mb250U2l6ZSA9IGZvbnRTaXplO1xyXG4gICAgdGhpcy5fY2FsY3VsYXRlTWV0cmljcygpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldCByb3RhdGlvbiBvZiB0ZXh0XHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHtudW1iZXJ9IGFuZ2xlIHJvdGF0aW9uIGluIHJhZGlhbnNcclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5wcm90b3R5cGUuc2V0Um90YXRpb24gPSBmdW5jdGlvbihhbmdsZSkge1xyXG4gICAgdGhpcy5fcm90YXRpb24gPSBhbmdsZTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgYW5jaG9yIHBvaW50IGZvciB0ZXh0IChob3Jpem9uYWwgYW5kIHZlcnRpY2FsIGFsaWdubWVudCkgcmVsYXRpdmUgdG9cclxuICogYm91bmRpbmcgYm94XHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHtzdHJpbmd9IFtoQWxpZ249Q0VOVEVSXSBob3Jpem9uYWwgYWxpZ25tZW50XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbdkFsaWduPUNFTlRFUl0gdmVydGljYWwgYmFzZWxpbmVcclxuICovXHJcbkJib3hBbGlnbmVkVGV4dC5wcm90b3R5cGUuc2V0QW5jaG9yID0gZnVuY3Rpb24oaEFsaWduLCB2QWxpZ24pIHtcclxuICAgIHRoaXMuX2hBbGlnbiA9IGhBbGlnbiB8fCBCYm94QWxpZ25lZFRleHQuQUxJR04uQ0VOVEVSO1xyXG4gICAgdGhpcy5fdkFsaWduID0gdkFsaWduIHx8IEJib3hBbGlnbmVkVGV4dC5CQVNFTElORS5DRU5URVI7XHJcbn07XHJcblxyXG4vKipcclxuICogRHJhd3MgdGhlIHRleHQgcGFydGljbGUgd2l0aCB0aGUgc3BlY2lmaWVkIHN0eWxlIHBhcmFtZXRlcnNcclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gIHtudW1iZXJ9ICB4ICAgICAgICAgICAgICAgICAgeCBjb29yZGluYXRlIG9mIHRleHQgYW5jaG9yXHJcbiAqIEBwYXJhbSAge251bWJlcn0gIHkgICAgICAgICAgICAgICAgICB5IGNvb3JkaW5hdGUgb2YgdGV4dCBhbmNob3JcclxuICogQHBhcmFtICB7Ym9vbGVhbn0gW2RyYXdCb3VuZHM9ZmFsc2VdIGZsYWcgZm9yIGRyYXdpbmcgYm91bmRpbmcgYm94XHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbih4LCB5LCBkcmF3Qm91bmRzKSB7XHJcbiAgICBkcmF3Qm91bmRzID0gZHJhd0JvdW5kcyB8fCBmYWxzZTtcclxuICAgIHZhciBwb3MgPSB7XHJcbiAgICAgICAgeDogKHggIT09IHVuZGVmaW5lZCkgPyB4IDogMCwgXHJcbiAgICAgICAgeTogKHkgIT09IHVuZGVmaW5lZCkgPyB5IDogMFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnAucHVzaCgpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fcm90YXRpb24pIHtcclxuICAgICAgICAgICAgcG9zID0gdGhpcy5fY2FsY3VsYXRlUm90YXRlZENvb3Jkcyhwb3MueCwgcG9zLnksIHRoaXMuX3JvdGF0aW9uKTtcclxuICAgICAgICAgICAgdGhpcy5wLnJvdGF0ZSh0aGlzLl9yb3RhdGlvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwb3MgPSB0aGlzLl9jYWxjdWxhdGVBbGlnbmVkQ29vcmRzKHBvcy54LCBwb3MueSk7XHJcblxyXG4gICAgICAgIHRoaXMucC50ZXh0QWxpZ24odGhpcy5wLkxFRlQsIHRoaXMucC5CQVNFTElORSk7XHJcbiAgICAgICAgdGhpcy5wLnRleHRGb250KHRoaXMuX2ZvbnQpO1xyXG4gICAgICAgIHRoaXMucC50ZXh0U2l6ZSh0aGlzLl9mb250U2l6ZSk7XHJcbiAgICAgICAgdGhpcy5wLnRleHQodGhpcy5fdGV4dCwgcG9zLngsIHBvcy55KTtcclxuXHJcbiAgICAgICAgaWYgKGRyYXdCb3VuZHMpIHtcclxuICAgICAgICAgICAgdGhpcy5wLnN0cm9rZSgyMDApO1xyXG4gICAgICAgICAgICB2YXIgYm91bmRzWCA9IHBvcy54ICsgdGhpcy5fYm91bmRzT2Zmc2V0Lng7XHJcbiAgICAgICAgICAgIHZhciBib3VuZHNZID0gcG9zLnkgKyB0aGlzLl9ib3VuZHNPZmZzZXQueTtcclxuICAgICAgICAgICAgdGhpcy5wLm5vRmlsbCgpO1xyXG4gICAgICAgICAgICB0aGlzLnAucmVjdChib3VuZHNYLCBib3VuZHNZLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7ICAgICAgICAgICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgIHRoaXMucC5wb3AoKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBQcm9qZWN0IHRoZSBjb29yZGluYXRlcyAoeCwgeSkgaW50byBhIHJvdGF0ZWQgY29vcmRpbmF0ZSBzeXN0ZW1cclxuICogQHByaXZhdGVcclxuICogQHBhcmFtICB7bnVtYmVyfSB4ICAgICB4IGNvb3JkaW5hdGUgKGluIHVucm90YXRlZCBzcGFjZSlcclxuICogQHBhcmFtICB7bnVtYmVyfSB5ICAgICB5IGNvb3JkaW5hdGUgKGluIHVucm90YXRlZCBzcGFjZSlcclxuICogQHBhcmFtICB7bnVtYmVyfSBhbmdsZSByYWRpYW5zIG9mIHJvdGF0aW9uIHRvIGFwcGx5XHJcbiAqIEByZXR1cm4ge29iamVjdH0gICAgICAgb2JqZWN0IHdpdGggeCAmIHkgcHJvcGVydGllc1xyXG4gKi9cclxuQmJveEFsaWduZWRUZXh0LnByb3RvdHlwZS5fY2FsY3VsYXRlUm90YXRlZENvb3JkcyA9IGZ1bmN0aW9uICh4LCB5LCBhbmdsZSkgeyAgXHJcbiAgICB2YXIgcnggPSBNYXRoLmNvcyhhbmdsZSkgKiB4ICsgTWF0aC5jb3MoTWF0aC5QSSAvIDIgLSBhbmdsZSkgKiB5O1xyXG4gICAgdmFyIHJ5ID0gLU1hdGguc2luKGFuZ2xlKSAqIHggKyBNYXRoLnNpbihNYXRoLlBJIC8gMiAtIGFuZ2xlKSAqIHk7XHJcbiAgICByZXR1cm4ge3g6IHJ4LCB5OiByeX07XHJcbn07XHJcblxyXG4vKipcclxuICogQ2FsY3VsYXRlcyBkcmF3IGNvb3JkaW5hdGVzIGZvciB0aGUgdGV4dCwgYWxpZ25pbmcgYmFzZWQgb24gdGhlIGJvdW5kaW5nIGJveC5cclxuICogVGhlIHRleHQgaXMgZXZlbnR1YWxseSBkcmF3biB3aXRoIGNhbnZhcyBhbGlnbm1lbnQgc2V0IHRvIGxlZnQgJiBiYXNlbGluZSwgc29cclxuICogdGhpcyBmdW5jdGlvbiB0YWtlcyBhIGRlc2lyZWQgcG9zICYgYWxpZ25tZW50IGFuZCByZXR1cm5zIHRoZSBhcHByb3ByaWF0ZVxyXG4gKiBjb29yZGluYXRlcyBmb3IgdGhlIGxlZnQgJiBiYXNlbGluZS5cclxuICogQHByaXZhdGVcclxuICogQHBhcmFtICB7bnVtYmVyfSB4ICAgICAgeCBjb29yZGluYXRlXHJcbiAqIEBwYXJhbSAge251bWJlcn0geSAgICAgIHkgY29vcmRpbmF0ZVxyXG4gKiBAcmV0dXJuIHtvYmplY3R9ICAgICAgICBvYmplY3Qgd2l0aCB4ICYgeSBwcm9wZXJ0aWVzXHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQucHJvdG90eXBlLl9jYWxjdWxhdGVBbGlnbmVkQ29vcmRzID0gZnVuY3Rpb24oeCwgeSkge1xyXG4gICAgdmFyIG5ld1gsIG5ld1k7XHJcbiAgICBzd2l0Y2ggKHRoaXMuX2hBbGlnbikge1xyXG4gICAgICAgIGNhc2UgQmJveEFsaWduZWRUZXh0LkFMSUdOLkxFRlQ6XHJcbiAgICAgICAgICAgIG5ld1ggPSB4O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEJib3hBbGlnbmVkVGV4dC5BTElHTi5DRU5URVI6XHJcbiAgICAgICAgICAgIG5ld1ggPSB4IC0gdGhpcy5oYWxmV2lkdGg7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQmJveEFsaWduZWRUZXh0LkFMSUdOLlJJR0hUOlxyXG4gICAgICAgICAgICBuZXdYID0geCAtIHRoaXMud2lkdGg7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld1ggPSB4O1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVucmVjb2duaXplZCBob3Jpem9uYWwgYWxpZ246XCIsIHRoaXMuX2hBbGlnbik7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoICh0aGlzLl92QWxpZ24pIHtcclxuICAgICAgICBjYXNlIEJib3hBbGlnbmVkVGV4dC5CQVNFTElORS5UT1A6XHJcbiAgICAgICAgICAgIG5ld1kgPSB5IC0gdGhpcy5fYm91bmRzT2Zmc2V0Lnk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQmJveEFsaWduZWRUZXh0LkJBU0VMSU5FLkNFTlRFUjpcclxuICAgICAgICAgICAgbmV3WSA9IHkgKyB0aGlzLl9kaXN0QmFzZVRvTWlkO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEJib3hBbGlnbmVkVGV4dC5CQVNFTElORS5CT1RUT006XHJcbiAgICAgICAgICAgIG5ld1kgPSB5IC0gdGhpcy5fZGlzdEJhc2VUb0JvdHRvbTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBCYm94QWxpZ25lZFRleHQuQkFTRUxJTkUuQUxQSEFCRVRJQzpcclxuICAgICAgICAgICAgbmV3WSA9IHk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIG5ld1kgPSB5O1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlVucmVjb2duaXplZCB2ZXJ0aWNhbCBhbGlnbjpcIiwgdGhpcy5fdkFsaWduKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge3g6IG5ld1gsIHk6IG5ld1l9O1xyXG59O1xyXG5cclxuXHJcbi8qKlxyXG4gKiBDYWxjdWxhdGVzIGJvdW5kaW5nIGJveCBhbmQgdmFyaW91cyBtZXRyaWNzIGZvciB0aGUgY3VycmVudCB0ZXh0IGFuZCBmb250XHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5CYm94QWxpZ25lZFRleHQucHJvdG90eXBlLl9jYWxjdWxhdGVNZXRyaWNzID0gZnVuY3Rpb24oKSB7ICBcclxuICAgIC8vIHA1IDAuNS4wIGhhcyBhIGJ1ZyAtIHRleHQgYm91bmRzIGFyZSBjbGlwcGVkIGJ5ICgwLCAwKVxyXG4gICAgLy8gQ2FsY3VsYXRpbmcgYm91bmRzIGhhY2tcclxuICAgIHZhciBib3VuZHMgPSB0aGlzLl9mb250LnRleHRCb3VuZHModGhpcy5fdGV4dCwgMTAwMCwgMTAwMCwgdGhpcy5fZm9udFNpemUpO1xyXG4gICAgYm91bmRzLnggLT0gMTAwMDtcclxuICAgIGJvdW5kcy55IC09IDEwMDA7XHJcblxyXG4gICAgLy8gVXNlIGJvdW5kcyB0byBjYWxjdWxhdGUgZm9udCBtZXRyaWNzXHJcbiAgICB0aGlzLndpZHRoID0gYm91bmRzLnc7XHJcbiAgICB0aGlzLmhlaWdodCA9IGJvdW5kcy5oO1xyXG4gICAgdGhpcy5oYWxmV2lkdGggPSB0aGlzLndpZHRoIC8gMjtcclxuICAgIHRoaXMuaGFsZkhlaWdodCA9IHRoaXMuaGVpZ2h0IC8gMjtcclxuICAgIHRoaXMuX2JvdW5kc09mZnNldCA9IHt4OiBib3VuZHMueCwgeTogYm91bmRzLnl9O1xyXG4gICAgdGhpcy5fZGlzdEJhc2VUb01pZCA9IE1hdGguYWJzKGJvdW5kcy55KSAtIHRoaXMuaGFsZkhlaWdodDtcclxuICAgIHRoaXMuX2Rpc3RCYXNlVG9Cb3R0b20gPSB0aGlzLmhlaWdodCAtIE1hdGguYWJzKGJvdW5kcy55KTtcclxufTtcbn0se31dfSx7fSxbMV0pKDEpXG59KTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
