<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"bbox-aligned-text.js.html":{"id":"bbox-aligned-text.js.html","title":"Source: bbox-aligned-text.js","body":" Documentation Classes BboxAlignedText Source: bbox-aligned-text.js var utils = require(&quot;./utils.js&quot;); module.exports = BboxAlignedText; /** * Creates a new BboxAlignedText object - a text object that can be drawn with * anchor points based on a tight bounding box around the text. * @constructor * @param {object} font - p5.Font object * @param {string} text - String to display * @param {number} [fontSize=12] - Font size to use for string * @param {number} [x=0] - Initial x location * @param {number} [y=0] - Initial y location * @param {object} [pInstance=window] - Reference to p5 instance, leave blank if * sketch is global * @example * var font, bboxText; * function preload() { * font = loadFont(&quot;./assets/Regular.ttf&quot;); * } * function setup() { * createCanvas(400, 600); * background(0); * * bboxText = new BboxAlignedText(font, &quot;Hey!&quot;, 30); * bboxText.setRotation(PI / 4); * bboxText.setAnchor(BboxAlignedText.ALIGN.BOX_CENTER, * BboxAlignedText.BASELINE.BOX_CENTER); * * fill(&quot;#00A8EA&quot;); * noStroke(); * bboxText.draw(width / 2, height / 2); * } */ function BboxAlignedText(font, text, fontSize, x, y, pInstance) { this._font = font; this._text = text; this._x = utils.default(x, 0); this._y = utils.default(y, 0); this._fontSize = utils.default(fontSize, 12); this._p = utils.default(pInstance, window); this._rotation = 0; this._hAlign = BboxAlignedText.ALIGN.BOX_CENTER; this._vAlign = BboxAlignedText.BASELINE.BOX_CENTER; this._calculateMetrics(true); } /** * Vertical alignment values * @public * @static * @readonly * @enum {string} */ BboxAlignedText.ALIGN = { /** Draw from the left of the bbox */ BOX_LEFT: &quot;box_left&quot;, /** Draw from the center of the bbox */ BOX_CENTER: &quot;box_center&quot;, /** Draw from the right of the bbox */ BOX_RIGHT: &quot;box_right&quot; }; /** * Baseline alignment values * @public * @static * @readonly * @enum {string} */ BboxAlignedText.BASELINE = { /** Draw from the top of the bbox */ BOX_TOP: &quot;box_top&quot;, /** Draw from the center of the bbox */ BOX_CENTER: &quot;box_center&quot;, /** Draw from the bottom of the bbox */ BOX_BOTTOM: &quot;box_bottom&quot;, /** * Draw from half the height of the font. Specifically the height is * calculated as: ascent + descent. */ FONT_CENTER: &quot;font_center&quot;, /** Draw from the the normal font baseline */ ALPHABETIC: &quot;alphabetic&quot; }; /** * Set current text * @public * @param {string} string - Text string to display * @returns {this} Useful for chaining */ BboxAlignedText.prototype.setText = function(string) { this._text = string; this._calculateMetrics(false); return this; }; /** * Set the text position * @public * @param {number} x - X position * @param {number} x - Y position * @returns {this} Useful for chaining */ BboxAlignedText.prototype.setPosition = function(x, y) { this._x = utils.default(x, this._x); this._y = utils.default(y, this._y); return this; }; /** * Get the text position * @public * @return {object} Returns an object with properties: x, y */ BboxAlignedText.prototype.getPosition = function() { return { x: this._x, y: this._y }; }; /** * Set current text size * @public * @param {number} fontSize Text size * @returns {this} Useful for chaining */ BboxAlignedText.prototype.setTextSize = function(fontSize) { this._fontSize = fontSize; this._calculateMetrics(true); return this; }; /** * Set rotation of text * @public * @param {number} angle - Rotation in radians * @returns {this} Useful for chaining */ BboxAlignedText.prototype.setRotation = function(angle) { this._rotation = utils.default(angle, this._rotation); return this; }; /** * Get rotation of text * @public * @returns {number} Rotation in radians */ BboxAlignedText.prototype.getRotation = function(angle) { return this._rotation; }; /** * Set the p instance that is used for drawing * @public * @param {object} p - Instance of p5 for drawing. This is only needed when * using an offscreen renderer or when using p5 in instance * mode. * @returns {this} Useful for chaining */ BboxAlignedText.prototype.setPInstance = function(p) { this._p = utils.default(p, this._p); return this; }; /** * Get rotation of text * @public * @returns {object} Instance of p5 that is being used for drawing */ BboxAlignedText.prototype.getPInstance = function() { return this._p; }; /** * Set anchor point for text (horizonal and vertical alignment) relative to * bounding box * @public * @param {string} [hAlign=CENTER] - Horizonal alignment * @param {string} [vAlign=CENTER] - Vertical baseline * @param {boolean} [updatePosition=false] - If set to true, the position of the * the text will be shifted so that * the text will be drawn in the same * place it was before calling * setAnchor. * @returns {this} Useful for chaining */ BboxAlignedText.prototype.setAnchor = function(hAlign, vAlign, updatePosition) { var oldPos = this._calculateAlignedCoords(this._x, this._y); this._hAlign = utils.default(hAlign, BboxAlignedText.ALIGN.CENTER); this._vAlign = utils.default(vAlign, BboxAlignedText.BASELINE.CENTER); if (updatePosition) { var newPos = this._calculateAlignedCoords(this._x, this._y); this._x += oldPos.x - newPos.x; this._y += oldPos.y - newPos.y; } return this; }; /** * Get the bounding box when the text is placed at the specified coordinates. * Note: this is the unrotated bounding box! TODO: Fix this. * @param {number} [x=current x] - A new x coordinate of text anchor. This * will change the text's x position * permanently. * @param {number} [y=current y] - A new y coordinate of text anchor. This * will change the text's x position * permanently. * @return {object} Returns an object with properties: x, y, w, h */ BboxAlignedText.prototype.getBbox = function(x, y) { this.setPosition(x, y); var pos = this._calculateAlignedCoords(this._x, this._y); return { x: pos.x + this._boundsOffset.x, y: pos.y + this._boundsOffset.y, w: this.width, h: this.height }; }; /** * Get an array of points that follow along the text path. This will take into * consideration the current alignment settings. * Note: this is a thin wrapper around a p5 method and doesn't handle unrotated * text! TODO: Fix this. * @param {number} [x=current x] - A new x coordinate of text anchor. This * will change the text's x position * permanently. * @param {number} [y=current y] - A new y coordinate of text anchor. This * will change the text's x position * permanently. * @param {object} [options] - An object that can have: * - sampleFactor: ratio of path-length to number * of samples (default=0.25). Higher values * yield morepoints and are therefore more * precise. * - simplifyThreshold: if set to a non-zero * value, collinear points will be removed. The * value represents the threshold angle to use * when determining whether two edges are * collinear. * @return {array} An array of points, each with x, y &amp; alpha (the path angle) */ BboxAlignedText.prototype.getTextPoints = function(x, y, options) { this.setPosition(x, y); var points = this._font.textToPoints(this._text, this._x, this._y, this._fontSize, options); for (var i = 0; i &lt; points.length; i += 1) { var pos = this._calculateAlignedCoords(points[i].x, points[i].y); points[i].x = pos.x; points[i].y = pos.y; } return points; }; /** * Draws the text particle with the specified style parameters. Note: this is * going to set the textFont, textSize &amp; rotation before drawing. You should set * the color/stroke/fill that you want before drawing. This function will clean * up after itself and reset styling back to what it was before it was called. * @public * @param {number} [x=current x] - A new x coordinate of text anchor. This will * change the text's x position permanently. * @param {number} [y=current y] - A new y coordinate of text anchor. This will * change the text's x position permanently. * @param {boolean} [drawBounds=false] - Flag for drawing bounding box */ BboxAlignedText.prototype.draw = function(x, y, drawBounds) { drawBounds = utils.default(drawBounds, false); this.setPosition(x, y); var pos = { x: this._x, y: this._y }; this._p.push(); if (this._rotation) { pos = this._calculateRotatedCoords(pos.x, pos.y, this._rotation); this._p.rotate(this._rotation); } pos = this._calculateAlignedCoords(pos.x, pos.y); this._p.textAlign(this._p.LEFT, this._p.BASELINE); this._p.textFont(this._font); this._p.textSize(this._fontSize); this._p.text(this._text, pos.x, pos.y); if (drawBounds) { this._p.stroke(200); var boundsX = pos.x + this._boundsOffset.x; var boundsY = pos.y + this._boundsOffset.y; this._p.noFill(); this._p.rect(boundsX, boundsY, this.width, this.height); } this._p.pop(); }; /** * Project the coordinates (x, y) into a rotated coordinate system * @private * @param {number} x - X coordinate (in unrotated space) * @param {number} y - Y coordinate (in unrotated space) * @param {number} angle - Radians of rotation to apply * @return {object} Object with x &amp; y properties */ BboxAlignedText.prototype._calculateRotatedCoords = function (x, y, angle) { var rx = Math.cos(angle) * x + Math.cos(Math.PI / 2 - angle) * y; var ry = -Math.sin(angle) * x + Math.sin(Math.PI / 2 - angle) * y; return {x: rx, y: ry}; }; /** * Calculates draw coordinates for the text, aligning based on the bounding box. * The text is eventually drawn with canvas alignment set to left &amp; baseline, so * this function takes a desired pos &amp; alignment and returns the appropriate * coordinates for the left &amp; baseline. * @private * @param {number} x - X coordinate * @param {number} y - Y coordinate * @return {object} Object with x &amp; y properties */ BboxAlignedText.prototype._calculateAlignedCoords = function(x, y) { var newX, newY; switch (this._hAlign) { case BboxAlignedText.ALIGN.BOX_LEFT: newX = x; break; case BboxAlignedText.ALIGN.BOX_CENTER: newX = x - this.halfWidth; break; case BboxAlignedText.ALIGN.BOX_RIGHT: newX = x - this.width; break; default: newX = x; console.log(&quot;Unrecognized horizonal align:&quot;, this._hAlign); break; } switch (this._vAlign) { case BboxAlignedText.BASELINE.BOX_TOP: newY = y - this._boundsOffset.y; break; case BboxAlignedText.BASELINE.BOX_CENTER: newY = y + this._distBaseToMid; break; case BboxAlignedText.BASELINE.BOX_BOTTOM: newY = y - this._distBaseToBottom; break; case BboxAlignedText.BASELINE.FONT_CENTER: // Height is approximated as ascent + descent newY = y - this._descent + (this._ascent + this._descent) / 2; break; case BboxAlignedText.BASELINE.ALPHABETIC: newY = y; break; default: newY = y; console.log(&quot;Unrecognized vertical align:&quot;, this._vAlign); break; } return {x: newX, y: newY}; }; /** * Calculates bounding box and various metrics for the current text and font * @private */ BboxAlignedText.prototype._calculateMetrics = function(shouldUpdateHeight) { // p5 0.5.0 has a bug - text bounds are clipped by (0, 0) // Calculating bounds hack var bounds = this._font.textBounds(this._text, 1000, 1000, this._fontSize); // Bounds is a reference - if we mess with it directly, we can mess up // future values! (It changes the bbox cache in p5.) bounds = { x: bounds.x - 1000, y: bounds.y - 1000, w: bounds.w, h: bounds.h }; if (shouldUpdateHeight) { this._ascent = this._font._textAscent(this._fontSize); this._descent = this._font._textDescent(this._fontSize); } // Use bounds to calculate font metrics this.width = bounds.w; this.height = bounds.h; this.halfWidth = this.width / 2; this.halfHeight = this.height / 2; this._boundsOffset = { x: bounds.x, y: bounds.y }; this._distBaseToMid = Math.abs(bounds.y) - this.halfHeight; this._distBaseToBottom = this.height - Math.abs(bounds.y); }; × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Classes BboxAlignedText Classes Classes BboxAlignedText × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Classes BboxAlignedText Bounding Box Aligned TextA JavaScript module for positioning p5.js text based on its bounding box. If you are looking to go just straight to the API documentation, you'll want to start here: BboxAlignedText. (Note: if you are viewing this on GitHub or NPM, you might want to check out the HTML documentation here.) Introductionp5.js is a wonderful creative coding library for JavaScript. The methods that p5.js provides for text placement (i.e. text anchor points) are based on a font's ascent, descent &amp; baseline (see &quot;Typography Metrics&quot;). This is exactly what you want when laying out words as legible text. Still, there are times when you would want to position text based on its exact bounding box. For example, you might have a particle system where words are particles that you want to position based on the center of the word and/or you want to do collision detection between words. (Demo code coming soon.) That's what this module provides - an easy way to position (and rotate) p5.js text based on its exact bounding box. ExamplesExample 1 &amp; 2 (live demo): Example 3 (live version): : Typography Metrics] InstallationStandalone ScriptIf you just want the standalone script to drop into a project: Unminified: bbox-aligned-text.js Minified: bbox-aligned-text.min.js NPMIf you have Node.js &amp; NPM (packaged with Node) installed, open a terminal in your project and run: npm install p5-bbox-aligned-textThis will install the module in ./node_modules/p5-bbox-aligned-text. You can then include the code into your project like this: &lt;script src=&quot;./node_modules/p5-bbox-aligned-text/dist/p5-bbox-aligned-text/bbox-aligned-text.min.js&quot;&gt;&lt;/script&gt;Or, if you are using browserify with your project, you can import the constructor function in your JS via: var BboxText = require(&quot;p5-bbox-aligned-text&quot;);Full API DocumentationDocumentation is online here. × Search results Close "},"BboxAlignedText.html":{"id":"BboxAlignedText.html","title":"Class: BboxAlignedText","body":" Documentation Classes BboxAlignedText Class: BboxAlignedText BboxAlignedText new BboxAlignedText(font, text, fontSize, x, y, pInstance) Creates a new BboxAlignedText object - a text object that can be drawn with anchor points based on a tight bounding box around the text. Parameters: Name Type Argument Default Description font object p5.Font object text string String to display fontSize number &lt;optional&gt; 12 Font size to use for string x number &lt;optional&gt; 0 Initial x location y number &lt;optional&gt; 0 Initial y location pInstance object &lt;optional&gt; window Reference to p5 instance, leave blank if sketch is global Source: bbox-aligned-text.js, line 35 Example var font, bboxText; function preload() { font = loadFont(&quot;./assets/Regular.ttf&quot;); } function setup() { createCanvas(400, 600); background(0); bboxText = new BboxAlignedText(font, &quot;Hey!&quot;, 30); bboxText.setRotation(PI / 4); bboxText.setAnchor(BboxAlignedText.ALIGN.BOX_CENTER, BboxAlignedText.BASELINE.BOX_CENTER); fill(&quot;#00A8EA&quot;); noStroke(); bboxText.draw(width / 2, height / 2); } Members &lt;static, readonly&gt; ALIGN :string Vertical alignment values Type: string Properties: Name Type Default Description BOX_LEFT string box_left Draw from the left of the bbox BOX_CENTER string box_center Draw from the center of the bbox BOX_RIGHT string box_right Draw from the right of the bbox Source: bbox-aligned-text.js, line 55 &lt;static, readonly&gt; BASELINE :string Baseline alignment values Type: string Properties: Name Type Default Description BOX_TOP string box_top Draw from the top of the bbox BOX_CENTER string box_center Draw from the center of the bbox BOX_BOTTOM string box_bottom Draw from the bottom of the bbox FONT_CENTER string font_center Draw from half the height of the font. Specifically the height is calculated as: ascent + descent. ALPHABETIC string alphabetic Draw from the the normal font baseline Source: bbox-aligned-text.js, line 71 Methods draw(x, y, drawBounds) Draws the text particle with the specified style parameters. Note: this is going to set the textFont, textSize &amp; rotation before drawing. You should set the color/stroke/fill that you want before drawing. This function will clean up after itself and reset styling back to what it was before it was called. Parameters: Name Type Argument Default Description x number &lt;optional&gt; current x A new x coordinate of text anchor. This will change the text's x position permanently. y number &lt;optional&gt; current y A new y coordinate of text anchor. This will change the text's x position permanently. drawBounds boolean &lt;optional&gt; false Flag for drawing bounding box Source: bbox-aligned-text.js, line 272 getBbox(x, y) Get the bounding box when the text is placed at the specified coordinates. Note: this is the unrotated bounding box! TODO: Fix this. Parameters: Name Type Argument Default Description x number &lt;optional&gt; current x A new x coordinate of text anchor. This will change the text's x position permanently. y number &lt;optional&gt; current y A new y coordinate of text anchor. This will change the text's x position permanently. Source: bbox-aligned-text.js, line 214 Returns: Returns an object with properties: x, y, w, h Type object getPInstance() Get rotation of text Source: bbox-aligned-text.js, line 174 Returns: Instance of p5 that is being used for drawing Type object getPosition() Get the text position Source: bbox-aligned-text.js, line 117 Returns: Returns an object with properties: x, y Type object getRotation() Get rotation of text Source: bbox-aligned-text.js, line 152 Returns: Rotation in radians Type number getTextPoints(x, y, options) Get an array of points that follow along the text path. This will take into consideration the current alignment settings. Note: this is a thin wrapper around a p5 method and doesn't handle unrotated text! TODO: Fix this. Parameters: Name Type Argument Default Description x number &lt;optional&gt; current x A new x coordinate of text anchor. This will change the text's x position permanently. y number &lt;optional&gt; current y A new y coordinate of text anchor. This will change the text's x position permanently. options object &lt;optional&gt; An object that can have: - sampleFactor: ratio of path-length to number of samples (default=0.25). Higher values yield morepoints and are therefore more precise. - simplifyThreshold: if set to a non-zero value, collinear points will be removed. The value represents the threshold angle to use when determining whether two edges are collinear. Source: bbox-aligned-text.js, line 248 Returns: An array of points, each with x, y &amp; alpha (the path angle) Type array setAnchor(hAlign, vAlign, updatePosition) Set anchor point for text (horizonal and vertical alignment) relative to bounding box Parameters: Name Type Argument Default Description hAlign string &lt;optional&gt; CENTER Horizonal alignment vAlign string &lt;optional&gt; CENTER Vertical baseline updatePosition boolean &lt;optional&gt; false If set to true, the position of the the text will be shifted so that the text will be drawn in the same place it was before calling setAnchor. Source: bbox-aligned-text.js, line 191 Returns: Useful for chaining Type this setPInstance(p) Set the p instance that is used for drawing Parameters: Name Type Description p object Instance of p5 for drawing. This is only needed when using an offscreen renderer or when using p5 in instance mode. Source: bbox-aligned-text.js, line 164 Returns: Useful for chaining Type this setPosition(x, x) Set the text position Parameters: Name Type Description x number X position x number Y position Source: bbox-aligned-text.js, line 106 Returns: Useful for chaining Type this setRotation(angle) Set rotation of text Parameters: Name Type Description angle number Rotation in radians Source: bbox-aligned-text.js, line 142 Returns: Useful for chaining Type this setText(string) Set current text Parameters: Name Type Description string string Text string to display Source: bbox-aligned-text.js, line 93 Returns: Useful for chaining Type this setTextSize(fontSize) Set current text size Parameters: Name Type Description fontSize number Text size Source: bbox-aligned-text.js, line 130 Returns: Useful for chaining Type this × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
